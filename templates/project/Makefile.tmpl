{{ if .Resources }}
app_bins = {{ range $r := .Resources -}}{{ range $f := $r.Functions}}bin/{{$r.Ident.Camelize}}/{{ $f.Handler }} {{ end }}{{ end }}
app_debugs = {{ range $r := .Resources -}}{{ range $f := $r.Functions}}debug/{{$r.Ident.Camelize}}/{{ $f.Handler }} {{ end }}{{ end }}
{{ end -}}

bin/% : functions/%/main.go
		env GOOS=linux go build -ldflags="-s -w" -o $@ $<

debug/%: functions/%/main.go
		 env GOARCH=amd64 GOOS=linux go build -gcflags='-N -l' -o $@ $<

build: vendor {{ if .Resources }}| $(app_bins){{ end }}

debug: vendor {{ if .Resources }}| $(app_debugs){{ end }}

vendor: Gopkg.toml
	    dep ensure